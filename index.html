<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Pengurusan Kokurikulum Sekolah</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
        }
        
        .flow-arrow {
            position: absolute;
            width: 60px;
            height: 2px;
            background: linear-gradient(90deg, #6366f1, #8b5cf6);
            border-radius: 1px;
        }
        
        .flow-arrow::after {
            content: '';
            position: absolute;
            right: -8px;
            top: -4px;
            width: 0;
            height: 0;
            border-left: 10px solid #8b5cf6;
            border-top: 5px solid transparent;
            border-bottom: 5px solid transparent;
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <div class="gradient-bg text-white py-8 px-6">
        <div class="max-w-7xl mx-auto text-center">
            <div class="flex items-center justify-center mb-4">
                <svg class="w-12 h-12 mr-4" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 3L1 9l4 2.18v6L12 21l7-3.82v-6l2-1.09V17h2V9L12 3zm6.82 6L12 12.72 5.18 9 12 5.28 18.82 9zM17 15.99l-5 2.73-5-2.73v-3.72L12 15l5-2.73v3.72z"/>
                </svg>
                <h1 class="text-4xl font-bold">Sistem Pengurusan Kokurikulum Sekolah</h1>
            </div>
            <p class="text-xl opacity-90">Dashboard Pengurusan Aktiviti dan Pencapaian Pelajar</p>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div class="max-w-7xl mx-auto px-6 py-12">
        <!-- Legend -->
        <div class="flex justify-center mb-12">
            <div class="bg-white rounded-2xl shadow-lg p-6 flex items-center space-x-8">
                <div class="flex items-center">
                    <div class="w-4 h-4 bg-blue-500 rounded-full mr-3"></div>
                    <span class="font-medium text-gray-700">Daftar (Register)</span>
                </div>
                <div class="flex items-center">
                    <div class="flow-arrow relative" style="width: 40px; top: 0;"></div>
                </div>
                <div class="flex items-center">
                    <div class="w-4 h-4 bg-purple-500 rounded-full mr-3"></div>
                    <span class="font-medium text-gray-700">Rekod (Record)</span>
                </div>
            </div>
        </div>

        <!-- Dashboard Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-8 relative">
            <!-- Row 1: Daftar (Registers) -->
            <!-- Daftar Keahlian -->
            <div class="bg-white rounded-2xl shadow-lg p-6 card-hover border-l-4 border-emerald-500 relative">
                <div class="flex items-center mb-4">
                    <div class="bg-emerald-100 p-3 rounded-xl mr-4">
                        <svg class="w-8 h-8 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"/>
                        </svg>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800 text-lg">Daftar Keahlian</h3>
                        <p class="text-sm text-gray-600">Membership Register</p>
                    </div>
                </div>
                <p class="text-gray-600 text-sm mb-4">Pendaftaran ahli baru kokurikulum</p>
                
                <!-- Open Form Button -->
                <button onclick="openMembershipForm()" class="w-full bg-emerald-600 text-white px-4 py-3 rounded-lg hover:bg-emerald-700 transition-colors font-medium flex items-center justify-center space-x-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                    </svg>
                    <span>Daftar Ahli Baru</span>
                </button>
                
                <!-- Flow arrow to record -->
                <div class="flow-arrow" style="right: -68px; top: 50%; transform: translateY(-50%);"></div>
            </div>

            <!-- Daftar Kehadiran -->
            <div class="bg-white rounded-2xl shadow-lg p-6 card-hover border-l-4 border-blue-500 relative">
                <div class="flex items-center mb-4">
                    <div class="bg-blue-100 p-3 rounded-xl mr-4">
                        <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>
                        </svg>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800 text-lg">Daftar Kehadiran</h3>
                        <p class="text-sm text-gray-600">Attendance Register</p>
                    </div>
                </div>
                <p class="text-gray-600 text-sm mb-4">Pendaftaran kehadiran pelajar dalam aktiviti kokurikulum</p>
                
                <!-- Open Form Button -->
                <button onclick="openAttendanceForm()" class="w-full bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center justify-center space-x-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                    </svg>
                    <span>Buka Daftar Kehadiran</span>
                </button>
                
                <!-- Flow arrow to record -->
                <div class="flow-arrow" style="right: -68px; top: 50%; transform: translateY(-50%);"></div>
            </div>

            <!-- Daftar Laporan Mingguan -->
            <div class="bg-white rounded-2xl shadow-lg p-6 card-hover border-l-4 border-green-500 relative">
                <div class="flex items-center mb-4">
                    <div class="bg-green-100 p-3 rounded-xl mr-4">
                        <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800 text-lg">Daftar Laporan Mingguan</h3>
                        <p class="text-sm text-gray-600">Weekly Report Register</p>
                    </div>
                </div>
                <p class="text-gray-600 text-sm">Pendaftaran laporan aktiviti mingguan</p>
                <!-- Flow arrow to record -->
                <div class="flow-arrow" style="right: -68px; top: 50%; transform: translateY(-50%);"></div>
            </div>

            <!-- Daftar Pencapaian Murid -->
            <div class="bg-white rounded-2xl shadow-lg p-6 card-hover border-l-4 border-yellow-500 relative">
                <div class="flex items-center mb-4">
                    <div class="bg-yellow-100 p-3 rounded-xl mr-4">
                        <svg class="w-8 h-8 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/>
                        </svg>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800 text-lg">Daftar Pencapaian Murid</h3>
                        <p class="text-sm text-gray-600">Student Achievement Register</p>
                    </div>
                </div>
                <p class="text-gray-600 text-sm">Pendaftaran pencapaian dan prestasi pelajar</p>
                <!-- Flow arrow to record -->
                <div class="flow-arrow" style="right: -68px; top: 50%; transform: translateY(-50%);"></div>
            </div>

            <!-- Daftar Jawatankuasa -->
            <div class="bg-white rounded-2xl shadow-lg p-6 card-hover border-l-4 border-red-500 relative">
                <div class="flex items-center mb-4">
                    <div class="bg-red-100 p-3 rounded-xl mr-4">
                        <svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                        </svg>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800 text-lg">Daftar Jawatankuasa</h3>
                        <p class="text-sm text-gray-600">Committee Register</p>
                    </div>
                </div>
                <p class="text-gray-600 text-sm">Pendaftaran ahli jawatankuasa dan peranan</p>
                <!-- Flow arrow to record -->
                <div class="flow-arrow" style="right: -68px; top: 50%; transform: translateY(-50%);"></div>
            </div>

            <!-- Row 2: Rekod (Records) -->
            <!-- Rekod Keahlian -->
            <div class="bg-white rounded-2xl shadow-lg p-6 card-hover border-l-4 border-cyan-500">
                <div class="flex items-center mb-4">
                    <div class="bg-cyan-100 p-3 rounded-xl mr-4">
                        <svg class="w-8 h-8 text-cyan-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                        </svg>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800 text-lg">Rekod Keahlian</h3>
                        <p class="text-sm text-gray-600">Membership Record</p>
                    </div>
                </div>
                <p class="text-gray-600 text-sm mb-4">Senarai ahli dan maklumat keahlian</p>
                
                <!-- View Records Button -->
                <button onclick="openMembershipRecords()" class="w-full bg-cyan-600 text-white px-4 py-3 rounded-lg hover:bg-cyan-700 transition-colors font-medium flex items-center justify-center space-x-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                    </svg>
                    <span>Lihat Rekod Keahlian</span>
                </button>
            </div>

            <!-- Rekod Kehadiran -->
            <div class="bg-white rounded-2xl shadow-lg p-6 card-hover border-l-4 border-purple-500">
                <div class="flex items-center mb-4">
                    <div class="bg-purple-100 p-3 rounded-xl mr-4">
                        <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                        </svg>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800 text-lg">Rekod Kehadiran</h3>
                        <p class="text-sm text-gray-600">Attendance Record</p>
                    </div>
                </div>
                <p class="text-gray-600 text-sm mb-4">Rekod dan analisis kehadiran pelajar</p>
                
                <!-- View Records Button -->
                <button onclick="openAttendanceRecords()" class="w-full bg-purple-600 text-white px-4 py-3 rounded-lg hover:bg-purple-700 transition-colors font-medium flex items-center justify-center space-x-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                    </svg>
                    <span>Lihat Rekod Kehadiran</span>
                </button>
            </div>

            <!-- Rekod Laporan Mingguan -->
            <div class="bg-white rounded-2xl shadow-lg p-6 card-hover border-l-4 border-indigo-500">
                <div class="flex items-center mb-4">
                    <div class="bg-indigo-100 p-3 rounded-xl mr-4">
                        <svg class="w-8 h-8 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"/>
                        </svg>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800 text-lg">Rekod Laporan Mingguan</h3>
                        <p class="text-sm text-gray-600">Weekly Report Record</p>
                    </div>
                </div>
                <p class="text-gray-600 text-sm">Rekod dan statistik laporan mingguan</p>
            </div>

            <!-- Rekod Pencapaian Murid -->
            <div class="bg-white rounded-2xl shadow-lg p-6 card-hover border-l-4 border-pink-500">
                <div class="flex items-center mb-4">
                    <div class="bg-pink-100 p-3 rounded-xl mr-4">
                        <svg class="w-8 h-8 text-pink-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"/>
                        </svg>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800 text-lg">Rekod Pencapaian Murid</h3>
                        <p class="text-sm text-gray-600">Student Achievement Record</p>
                    </div>
                </div>
                <p class="text-gray-600 text-sm">Rekod dan portfolio pencapaian pelajar</p>
            </div>

            <!-- Rekod Jawatankuasa -->
            <div class="bg-white rounded-2xl shadow-lg p-6 card-hover border-l-4 border-teal-500">
                <div class="flex items-center mb-4">
                    <div class="bg-teal-100 p-3 rounded-xl mr-4">
                        <svg class="w-8 h-8 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
                        </svg>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800 text-lg">Rekod Jawatankuasa</h3>
                        <p class="text-sm text-gray-600">Committee Record</p>
                    </div>
                </div>
                <p class="text-gray-600 text-sm">Rekod aktiviti dan prestasi jawatankuasa</p>
            </div>
        </div>

        <!-- School Elements -->
        <div class="mt-16 text-center">
            <div class="flex justify-center items-center space-x-8 text-6xl opacity-20">
                📚 👨‍🎓 👩‍🎓 📋 🏆 📊 🎯 📝
            </div>
        </div>

        <!-- Footer Info -->
        <div class="mt-12 bg-white rounded-2xl shadow-lg p-8">
            <div class="text-center">
                <h3 class="text-2xl font-bold text-gray-800 mb-4">Cara Penggunaan Sistem</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-8">
                    <div class="text-left">
                        <h4 class="font-semibold text-lg text-blue-600 mb-3">📝 Daftar (Register)</h4>
                        <ul class="space-y-2 text-gray-600">
                            <li>• Pendaftaran data awal</li>
                            <li>• Input maklumat baru</li>
                            <li>• Pengesahan data</li>
                            <li>• Proses kemasukan</li>
                        </ul>
                    </div>
                    <div class="text-left">
                        <h4 class="font-semibold text-lg text-purple-600 mb-3">📊 Rekod (Record)</h4>
                        <ul class="space-y-2 text-gray-600">
                            <li>• Penyimpanan data</li>
                            <li>• Analisis dan laporan</li>
                            <li>• Pemantauan prestasi</li>
                            <li>• Arkib maklumat</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Attendance Form Modal -->
    <div id="attendanceModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto">
                <!-- Modal Header -->
                <div class="bg-blue-600 text-white p-6 rounded-t-2xl">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <svg class="w-8 h-8 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>
                            </svg>
                            <div>
                                <h2 class="text-2xl font-bold">Borang Daftar Kehadiran</h2>
                                <p class="text-blue-100">Pendaftaran Kehadiran Pelajar Kokurikulum</p>
                            </div>
                        </div>
                        <button onclick="closeAttendanceForm()" class="text-white hover:text-gray-200 p-2">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Modal Content -->
                <div class="p-6">
                    <form id="attendanceForm" class="space-y-6">
                        <!-- Form Header -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Tarikh</label>
                                <input type="date" id="attendanceDate" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Aktiviti</label>
                                <select id="activityType" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                                    <option value="">Pilih Aktiviti</option>
                                    <option value="badminton">Badminton</option>
                                    <option value="bola-sepak">Bola Sepak</option>
                                    <option value="bola-keranjang">Bola Keranjang</option>
                                    <option value="kelab-sains">Kelab Sains</option>
                                    <option value="kelab-matematik">Kelab Matematik</option>
                                    <option value="kelab-bahasa">Kelab Bahasa</option>
                                    <option value="persatuan-sejarah">Persatuan Sejarah</option>
                                    <option value="kadet-polis">Kadet Polis</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Masa</label>
                                <input type="time" id="attendanceTime" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                            </div>
                        </div>

                        <!-- Student Registration Section -->
                        <div class="border-t pt-6">
                            <h4 class="text-lg font-semibold text-gray-800 mb-4">Pendaftaran Kehadiran Pelajar</h4>
                            
                            <!-- Student Selection Method -->
                            <div class="bg-gray-50 rounded-lg p-4 mb-4 border border-gray-200">
                                <div class="flex items-center justify-between mb-4">
                                    <h5 class="font-medium text-gray-800">Pilih Kaedah Pendaftaran Pelajar</h5>
                                    <div class="flex bg-white rounded-lg p-1 border">
                                        <button type="button" id="selectFromListBtn" onclick="switchToSelectMode()" class="px-4 py-2 text-sm font-medium rounded-md bg-blue-600 text-white">
                                            📋 Pilih dari Senarai
                                        </button>
                                        <button type="button" id="manualEntryBtn" onclick="switchToManualMode()" class="px-4 py-2 text-sm font-medium rounded-md text-gray-600 hover:text-gray-800">
                                            ✏️ Input Manual
                                        </button>
                                    </div>
                                </div>

                                <!-- Select from List Mode -->
                                <div id="selectFromListMode" class="space-y-4">
                                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                        <div class="flex items-center mb-3">
                                            <svg class="w-5 h-5 text-blue-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                            </svg>
                                            <span class="text-blue-800 font-medium text-sm">Senarai pelajar akan dipaparkan berdasarkan aktiviti yang dipilih</span>
                                        </div>
                                        <div id="studentListContainer" class="hidden">
                                            <h6 class="font-medium text-gray-700 mb-3">Senarai Ahli <span id="selectedActivityName"></span>:</h6>
                                            <div id="studentCheckboxList" class="grid grid-cols-1 md:grid-cols-2 gap-2 max-h-60 overflow-y-auto">
                                                <!-- Student checkboxes will be populated here -->
                                            </div>
                                            <div class="mt-4 flex justify-between items-center">
                                                <button type="button" onclick="selectAllStudents()" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                                                    ✅ Pilih Semua
                                                </button>
                                                <button type="button" onclick="clearAllStudents()" class="text-red-600 hover:text-red-800 text-sm font-medium">
                                                    ❌ Kosongkan Pilihan
                                                </button>
                                            </div>
                                        </div>
                                        <div id="noActivitySelected" class="text-center py-4 text-gray-500">
                                            <svg class="w-12 h-12 mx-auto mb-2 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                            </svg>
                                            <p class="text-sm">Sila pilih aktiviti terlebih dahulu untuk melihat senarai pelajar</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Manual Entry Mode -->
                                <div id="manualEntryMode" class="hidden">
                                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Nama Pelajar</label>
                                            <input type="text" id="studentName" placeholder="Nama penuh pelajar" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">No. K/P atau No. Pelajar</label>
                                            <input type="text" id="studentId" placeholder="123456-78-9012" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Kelas</label>
                                            <select id="studentClass" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                                <option value="">Pilih Kelas</option>
                                                <option value="1A">Tingkatan 1A</option>
                                                <option value="1B">Tingkatan 1B</option>
                                                <option value="2A">Tingkatan 2A</option>
                                                <option value="2B">Tingkatan 2B</option>
                                                <option value="3A">Tingkatan 3A</option>
                                                <option value="3B">Tingkatan 3B</option>
                                                <option value="4A">Tingkatan 4A</option>
                                                <option value="4B">Tingkatan 4B</option>
                                                <option value="5A">Tingkatan 5A</option>
                                                <option value="5B">Tingkatan 5B</option>
                                            </select>
                                        </div>
                                        <div class="flex items-end">
                                            <button type="button" onclick="addStudentManually()" class="w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium">
                                                ➕ Tambah Pelajar
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Attendance List -->
                            <div class="bg-white rounded-lg border border-gray-200">
                                <div class="px-4 py-3 bg-gray-50 border-b border-gray-200 rounded-t-lg">
                                    <h5 class="font-medium text-gray-800">Senarai Kehadiran</h5>
                                </div>
                                <div id="attendanceList" class="p-4">
                                    <p class="text-gray-500 text-center py-8">Belum ada pelajar didaftarkan. Sila tambah pelajar di atas.</p>
                                </div>
                            </div>

                            <!-- Form Actions -->
                            <div class="flex justify-between items-center mt-6 pt-4 border-t border-gray-200">
                                <div class="text-sm text-gray-600">
                                    <span id="totalStudents">0</span> pelajar didaftarkan
                                </div>
                                <div class="space-x-3">
                                    <button type="button" onclick="clearForm()" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
                                        🗑️ Kosongkan
                                    </button>
                                    <button type="submit" class="px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium">
                                        💾 Simpan Kehadiran
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Membership Form Modal -->
    <div id="membershipModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <!-- Modal Header -->
                <div class="bg-emerald-600 text-white p-6 rounded-t-2xl">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <svg class="w-8 h-8 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"/>
                            </svg>
                            <div>
                                <h2 class="text-2xl font-bold">Borang Daftar Keahlian</h2>
                                <p class="text-emerald-100">Pendaftaran Ahli Baru Kokurikulum</p>
                            </div>
                        </div>
                        <button onclick="closeMembershipForm()" class="text-white hover:text-gray-200 p-2">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Modal Content -->
                <div class="p-6">
                    <form id="membershipForm" class="space-y-6">
                        <!-- Timestamp (Auto-generated) -->
                        <div class="bg-gray-100 rounded-lg p-4 border border-gray-300">
                            <div class="flex items-center">
                                <svg class="w-5 h-5 mr-2 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                <span class="text-sm font-medium text-gray-700">Timestamp: </span>
                                <span id="memberTimestamp" class="text-sm text-gray-800 font-mono"></span>
                            </div>
                        </div>

                        <!-- Co-curricular Selection -->
                        <div class="bg-blue-50 rounded-lg p-6 border border-blue-200">
                            <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                                <svg class="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"/>
                                </svg>
                                Pilihan Kokurikulum
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Jenis Kokurikulum *</label>
                                    <select id="memberCoCurricularType" onchange="updateUnitOptions()" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500" required>
                                        <option value="">Pilih Jenis Kokurikulum</option>
                                        <option value="kelab-persatuan">Kelab dan Persatuan</option>
                                        <option value="sukan-permainan">Sukan dan Permainan</option>
                                        <option value="badan-beruniform">Badan Beruniform</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Unit *</label>
                                    <select id="memberUnit" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500" required disabled>
                                        <option value="">Pilih jenis kokurikulum dahulu</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Personal Information -->
                        <div class="bg-gray-50 rounded-lg p-6 border border-gray-200">
                            <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                                <svg class="w-5 h-5 mr-2 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                                </svg>
                                Maklumat Peribadi Pelajar
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Tingkatan *</label>
                                    <select id="memberForm" onchange="updateClassOptions()" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500" required>
                                        <option value="">Pilih Tingkatan</option>
                                        <option value="1">Tingkatan 1</option>
                                        <option value="2">Tingkatan 2</option>
                                        <option value="3">Tingkatan 3</option>
                                        <option value="4">Tingkatan 4</option>
                                        <option value="5">Tingkatan 5</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Kelas *</label>
                                    <select id="memberClass" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500" required disabled>
                                        <option value="">Pilih tingkatan dahulu</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Penuh *</label>
                                    <input type="text" id="memberName" placeholder="Nama penuh pelajar" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Jantina *</label>
                                    <select id="memberGender" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500" required>
                                        <option value="">Pilih Jantina</option>
                                        <option value="lelaki">Lelaki</option>
                                        <option value="perempuan">Perempuan</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">No. Kad Pengenalan *</label>
                                    <input type="text" id="memberId" placeholder="123456-78-9012" pattern="[0-9]{6}-[0-9]{2}-[0-9]{4}" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500" required>
                                    <p class="text-xs text-gray-500 mt-1">Format: 123456-78-9012</p>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">No. Telefon Ibu/Bapa *</label>
                                    <input type="tel" id="memberParentPhone" placeholder="012-3456789" pattern="[0-9]{3}-[0-9]{7,8}" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500" required>
                                    <p class="text-xs text-gray-500 mt-1">Format: 012-3456789</p>
                                </div>
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div class="flex justify-between items-center pt-4 border-t border-gray-200">
                            <div class="text-sm text-gray-600">
                                * Medan wajib diisi
                            </div>
                            <div class="space-x-3">
                                <button type="button" onclick="clearMembershipForm()" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
                                    🗑️ Kosongkan
                                </button>
                                <button type="submit" class="px-6 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors font-medium">
                                    💾 Daftar Ahli
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Membership Records Modal -->
    <div id="membershipRecordsModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl shadow-2xl max-w-7xl w-full max-h-[90vh] overflow-y-auto">
                <!-- Modal Header -->
                <div class="bg-cyan-600 text-white p-6 rounded-t-2xl">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <svg class="w-8 h-8 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                            </svg>
                            <div>
                                <h2 class="text-2xl font-bold">Rekod Keahlian</h2>
                                <p class="text-cyan-100">Senarai Ahli Kokurikulum yang Berdaftar</p>
                            </div>
                        </div>
                        <button onclick="closeMembershipRecords()" class="text-white hover:text-gray-200 p-2">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Modal Content -->
                <div class="p-6">
                    <!-- Summary Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <div class="bg-emerald-50 p-4 rounded-lg border border-emerald-200">
                            <div class="text-emerald-600 text-sm font-medium">Jumlah Ahli</div>
                            <div class="text-2xl font-bold text-emerald-800" id="totalMembers">0</div>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                            <div class="text-blue-600 text-sm font-medium">Ahli Aktif</div>
                            <div class="text-2xl font-bold text-blue-800" id="activeMembers">0</div>
                        </div>
                        <div class="bg-yellow-50 p-4 rounded-lg border border-yellow-200">
                            <div class="text-yellow-600 text-sm font-medium">Unit Terpopular</div>
                            <div class="text-lg font-bold text-yellow-800" id="popularActivity">-</div>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
                            <div class="text-purple-600 text-sm font-medium">Ahli Terbaru</div>
                            <div class="text-lg font-bold text-purple-800" id="latestMember">-</div>
                        </div>
                    </div>

                    <!-- Filter Section -->
                    <div class="bg-gray-50 rounded-lg p-4 mb-6 border border-gray-200">
                        <div class="flex flex-wrap items-center gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Tapis mengikut Jenis</label>
                                <select id="filterCoCurricularType" onchange="filterMembershipRecords()" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500">
                                    <option value="">Semua Jenis</option>
                                    <option value="kelab-persatuan">Kelab dan Persatuan</option>
                                    <option value="sukan-permainan">Sukan dan Permainan</option>
                                    <option value="badan-beruniform">Badan Beruniform</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Tapis mengikut Jantina</label>
                                <select id="filterGender" onchange="filterMembershipRecords()" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500">
                                    <option value="">Semua Jantina</option>
                                    <option value="lelaki">Lelaki</option>
                                    <option value="perempuan">Perempuan</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Cari Ahli</label>
                                <input type="text" id="searchMember" placeholder="Nama atau No. K/P" onkeyup="filterMembershipRecords()" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500">
                            </div>
                        </div>
                    </div>

                    <!-- Members List -->
                    <div class="bg-white rounded-lg border border-gray-200">
                        <div class="px-6 py-4 bg-gray-50 border-b border-gray-200 rounded-t-lg">
                            <h3 class="font-semibold text-gray-800 text-lg">Senarai Ahli Kokurikulum</h3>
                        </div>
                        <div id="membersList" class="p-6">
                            <div class="text-center py-12 text-gray-500">
                                <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                                </svg>
                                <p class="text-lg font-medium">Tiada ahli berdaftar lagi</p>
                                <p class="text-sm">Sila daftar ahli baru terlebih dahulu untuk melihat rekod di sini</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Attendance Records Modal -->
    <div id="attendanceRecordsModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl shadow-2xl max-w-7xl w-full max-h-[90vh] overflow-y-auto">
                <!-- Modal Header -->
                <div class="bg-purple-600 text-white p-6 rounded-t-2xl">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <svg class="w-8 h-8 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                            </svg>
                            <div>
                                <h2 class="text-2xl font-bold">Rekod Kehadiran</h2>
                                <p class="text-purple-100">Senarai Kehadiran Pelajar yang Telah Disimpan</p>
                            </div>
                        </div>
                        <button onclick="closeAttendanceRecords()" class="text-white hover:text-gray-200 p-2">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Modal Content -->
                <div class="p-6">
                    <!-- Summary Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                            <div class="text-blue-600 text-sm font-medium">Jumlah Rekod</div>
                            <div class="text-2xl font-bold text-blue-800" id="totalRecords">0</div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                            <div class="text-green-600 text-sm font-medium">Jumlah Pelajar</div>
                            <div class="text-2xl font-bold text-green-800" id="totalStudentsInRecords">0</div>
                        </div>
                        <div class="bg-yellow-50 p-4 rounded-lg border border-yellow-200">
                            <div class="text-yellow-600 text-sm font-medium">Aktiviti Terbanyak</div>
                            <div class="text-lg font-bold text-yellow-800" id="mostPopularActivity">-</div>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
                            <div class="text-purple-600 text-sm font-medium">Rekod Terkini</div>
                            <div class="text-lg font-bold text-purple-800" id="latestRecord">-</div>
                        </div>
                    </div>

                    <!-- Records List -->
                    <div class="bg-white rounded-lg border border-gray-200">
                        <div class="px-6 py-4 bg-gray-50 border-b border-gray-200 rounded-t-lg">
                            <h3 class="font-semibold text-gray-800 text-lg">Senarai Rekod Kehadiran</h3>
                        </div>
                        <div id="recordsList" class="p-6">
                            <div class="text-center py-12 text-gray-500">
                                <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                </svg>
                                <p class="text-lg font-medium">Tiada rekod kehadiran lagi</p>
                                <p class="text-sm">Sila daftar kehadiran terlebih dahulu untuk melihat rekod di sini</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let attendanceData = [];
        let studentCounter = 0;
        let savedAttendanceRecords = [];
        let membershipData = [];
        let savedMembershipRecords = [];
        let filteredMembershipRecords = [];

        // Database of students organized by co-curricular activities
        const studentDatabase = {
            'badminton': [
                { name: 'Ahmad Faiz bin Abdullah', id: '051234-05-1234', class: '4A' },
                { name: 'Siti Nurhaliza binti Hassan', id: '051235-05-1235', class: '4B' },
                { name: 'Muhammad Aidil bin Rahman', id: '051236-05-1236', class: '5A' },
                { name: 'Nurul Aina binti Zakaria', id: '051237-05-1237', class: '4A' },
                { name: 'Khairul Anwar bin Ismail', id: '051238-05-1238', class: '5B' },
                { name: 'Farah Diyana binti Ahmad', id: '051239-05-1239', class: '4B' }
            ],
            'bola-sepak': [
                { name: 'Muhammad Haziq bin Omar', id: '051240-05-1240', class: '5A' },
                { name: 'Aiman Hakim bin Rosli', id: '051241-05-1241', class: '4A' },
                { name: 'Danial Irfan bin Sulaiman', id: '051242-05-1242', class: '5B' },
                { name: 'Arif Hakimi bin Mohd Ali', id: '051243-05-1243', class: '4B' },
                { name: 'Zulkarnain bin Ibrahim', id: '051244-05-1244', class: '5A' },
                { name: 'Hafiz Iman bin Razak', id: '051245-05-1245', class: '4A' }
            ],
            'bola-keranjang': [
                { name: 'Alya Damia binti Kamal', id: '051246-05-1246', class: '4B' },
                { name: 'Iman Sofea binti Yusof', id: '051247-05-1247', class: '5A' },
                { name: 'Qistina Balqis binti Hamid', id: '051248-05-1248', class: '4A' },
                { name: 'Nur Batrisyia binti Azman', id: '051249-05-1249', class: '5B' },
                { name: 'Aishah Humaira binti Nasir', id: '051250-05-1250', class: '4B' },
                { name: 'Puteri Aisyah binti Razali', id: '051251-05-1251', class: '5A' }
            ],
            'kelab-sains': [
                { name: 'Lim Wei Ming', id: '051252-05-1252', class: '5A' },
                { name: 'Tan Hui Ling', id: '051253-05-1253', class: '4A' },
                { name: 'Wong Kar Wai', id: '051254-05-1254', class: '5B' },
                { name: 'Lee Xin Yi', id: '051255-05-1255', class: '4B' },
                { name: 'Chong Wei Jie', id: '051256-05-1256', class: '5A' },
                { name: 'Ng Shu Ting', id: '051257-05-1257', class: '4A' }
            ],
            'kelab-matematik': [
                { name: 'Rajesh Kumar a/l Subramaniam', id: '051258-05-1258', class: '5A' },
                { name: 'Priya Devi a/p Krishnan', id: '051259-05-1259', class: '4B' },
                { name: 'Vikram Singh a/l Jasbir', id: '051260-05-1260', class: '5B' },
                { name: 'Kavitha a/p Raman', id: '051261-05-1261', class: '4A' },
                { name: 'Arjun a/l Mohan', id: '051262-05-1262', class: '5A' },
                { name: 'Deepika a/p Selvam', id: '051263-05-1263', class: '4B' }
            ],
            'kelab-bahasa': [
                { name: 'Nur Syafiqah binti Mahmud', id: '051264-05-1264', class: '4A' },
                { name: 'Izzati Syahirah binti Kadir', id: '051265-05-1265', class: '5B' },
                { name: 'Amirah Sofiya binti Rashid', id: '051266-05-1266', class: '4B' },
                { name: 'Nabilah Insyirah binti Aziz', id: '051267-05-1267', class: '5A' },
                { name: 'Wardina Safiyyah binti Halim', id: '051268-05-1268', class: '4A' },
                { name: 'Zara Ameena binti Fauzi', id: '051269-05-1269', class: '5B' }
            ],
            'persatuan-sejarah': [
                { name: 'Muhammad Luqman bin Hakim', id: '051270-05-1270', class: '5A' },
                { name: 'Nur Izzah binti Samsudin', id: '051271-05-1271', class: '4B' },
                { name: 'Haris Danial bin Zulkifli', id: '051272-05-1272', class: '5B' },
                { name: 'Sofea Adriana binti Hashim', id: '051273-05-1273', class: '4A' },
                { name: 'Irfan Hakeem bin Nordin', id: '051274-05-1274', class: '5A' },
                { name: 'Amira Yasmin binti Ghazali', id: '051275-05-1275', class: '4B' }
            ],
            'kadet-polis': [
                { name: 'Afiq Danial bin Roslan', id: '051276-05-1276', class: '5B' },
                { name: 'Nur Aleya binti Mansor', id: '051277-05-1277', class: '4A' },
                { name: 'Zikri Hakim bin Baharuddin', id: '051278-05-1278', class: '5A' },
                { name: 'Aina Mardhiah binti Shaari', id: '051279-05-1279', class: '4B' },
                { name: 'Hazwan Fikri bin Azhar', id: '051280-05-1280', class: '5B' },
                { name: 'Balqis Humaira binti Ramli', id: '051281-05-1281', class: '4A' }
            ]
        };

        function openAttendanceForm() {
            document.getElementById('attendanceModal').classList.remove('hidden');
            // Set today's date as default
            document.getElementById('attendanceDate').value = new Date().toISOString().split('T')[0];
            
            // Set current time as default
            const now = new Date();
            const timeString = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');
            document.getElementById('attendanceTime').value = timeString;
        }

        function closeAttendanceForm() {
            document.getElementById('attendanceModal').classList.add('hidden');
        }

        function openAttendanceRecords() {
            document.getElementById('attendanceRecordsModal').classList.remove('hidden');
            displayAttendanceRecords();
        }

        function closeAttendanceRecords() {
            document.getElementById('attendanceRecordsModal').classList.add('hidden');
        }

        // Close modal when clicking outside
        document.getElementById('attendanceModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeAttendanceForm();
            }
        });

        // Close records modal when clicking outside
        document.getElementById('attendanceRecordsModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeAttendanceRecords();
            }
        });

        function openMembershipForm() {
            document.getElementById('membershipModal').classList.remove('hidden');
            // Set current timestamp
            updateTimestamp();
        }

        function updateTimestamp() {
            const now = new Date();
            const timestamp = now.toLocaleString('ms-MY', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            document.getElementById('memberTimestamp').textContent = timestamp;
        }

        function updateUnitOptions() {
            const coCurricularType = document.getElementById('memberCoCurricularType').value;
            const unitSelect = document.getElementById('memberUnit');
            
            // Clear existing options
            unitSelect.innerHTML = '<option value="">Pilih Unit</option>';
            
            if (!coCurricularType) {
                unitSelect.disabled = true;
                unitSelect.innerHTML = '<option value="">Pilih jenis kokurikulum dahulu</option>';
                return;
            }
            
            unitSelect.disabled = false;
            
            let units = [];
            
            switch(coCurricularType) {
                case 'kelab-persatuan':
                    units = [
                        'Bahasa Melayu',
                        'Bahasa Arab', 
                        'Bahasa Inggeris',
                        'Inovasi dan Reka Cipta',
                        'STEM',
                        'Kebudayaan',
                        'Fotografi',
                        'Seni dan Khat',
                        'Pencegahan Jenayah',
                        'Nadi Huffaz/Qurra\'',
                        'Kerjaya dan Bimbingan Kaunseling',
                        'Usahawan Muda'
                    ];
                    break;
                case 'sukan-permainan':
                    units = [
                        'Bola Sepak',
                        'Bola Tampar',
                        'Memanah Lelaki',
                        'Ping Pong Lelaki',
                        'Bola Jaring',
                        'Bola Baling',
                        'Memanah Perempuan',
                        'Ping Pong Perempuan'
                    ];
                    break;
                case 'badan-beruniform':
                    units = [
                        'Kadet Remaja Sekolah',
                        'Kadet Sekolah Pertahanan Awam (L)',
                        'Bulan Sabit Merah Malaysia (L)',
                        'Pergerakan Puteri Islam Malaysia',
                        'Kadet Sekolah Pertahanan Awam (P)',
                        'Bulan Sabit Merah Malaysia (P)'
                    ];
                    break;
            }
            
            units.forEach(unit => {
                const option = document.createElement('option');
                option.value = unit.toLowerCase().replace(/\s+/g, '-').replace(/[()]/g, '').replace(/'/g, '');
                option.textContent = unit;
                unitSelect.appendChild(option);
            });
        }

        function updateClassOptions() {
            const formLevel = document.getElementById('memberForm').value;
            const classSelect = document.getElementById('memberClass');
            
            // Clear existing options
            classSelect.innerHTML = '<option value="">Pilih Kelas</option>';
            
            if (!formLevel) {
                classSelect.disabled = true;
                classSelect.innerHTML = '<option value="">Pilih tingkatan dahulu</option>';
                return;
            }
            
            classSelect.disabled = false;
            
            let classes = [];
            
            switch(formLevel) {
                case '1':
                    classes = ['Hikmah', 'Fatonah', 'Amanah', 'Hasanah'];
                    break;
                case '2':
                    classes = ['Hikmah', 'Fatonah', 'Amanah', 'Hasanah'];
                    break;
                case '3':
                    classes = ['Hikmah', 'Fatonah', 'Amanah', 'Hasanah'];
                    break;
                case '4':
                    classes = ['Taqwa', 'Fatonah', 'Amanah', 'Syariah'];
                    break;
                case '5':
                    classes = ['Taqwa', 'Fatonah', 'Amanah', 'Syariah'];
                    break;
            }
            
            classes.forEach(className => {
                const option = document.createElement('option');
                option.value = `${formLevel} ${className}`;
                option.textContent = className;
                classSelect.appendChild(option);
            });
        }

        function closeMembershipForm() {
            document.getElementById('membershipModal').classList.add('hidden');
        }

        function openMembershipRecords() {
            document.getElementById('membershipRecordsModal').classList.remove('hidden');
            displayMembershipRecords();
        }

        function closeMembershipRecords() {
            document.getElementById('membershipRecordsModal').classList.add('hidden');
        }

        // Close membership modal when clicking outside
        document.getElementById('membershipModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeMembershipForm();
            }
        });

        // Close membership records modal when clicking outside
        document.getElementById('membershipRecordsModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeMembershipRecords();
            }
        });

        function displayAttendanceRecords() {
            const recordsList = document.getElementById('recordsList');
            const totalRecordsEl = document.getElementById('totalRecords');
            const totalStudentsEl = document.getElementById('totalStudentsInRecords');
            const mostPopularActivityEl = document.getElementById('mostPopularActivity');
            const latestRecordEl = document.getElementById('latestRecord');

            if (savedAttendanceRecords.length === 0) {
                recordsList.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                        <p class="text-lg font-medium">Tiada rekod kehadiran lagi</p>
                        <p class="text-sm">Sila daftar kehadiran terlebih dahulu untuk melihat rekod di sini</p>
                    </div>
                `;
                totalRecordsEl.textContent = '0';
                totalStudentsEl.textContent = '0';
                mostPopularActivityEl.textContent = '-';
                latestRecordEl.textContent = '-';
                return;
            }

            // Calculate statistics
            const totalRecords = savedAttendanceRecords.length;
            const totalStudents = savedAttendanceRecords.reduce((sum, record) => sum + record.totalStudents, 0);
            
            // Find most popular activity
            const activityCount = {};
            savedAttendanceRecords.forEach(record => {
                activityCount[record.activity] = (activityCount[record.activity] || 0) + 1;
            });
            const mostPopular = Object.keys(activityCount).reduce((a, b) => activityCount[a] > activityCount[b] ? a : b, '-');
            
            // Latest record
            const latest = savedAttendanceRecords[savedAttendanceRecords.length - 1];
            const latestDate = new Date(latest.date).toLocaleDateString('ms-MY');

            // Update statistics
            totalRecordsEl.textContent = totalRecords;
            totalStudentsEl.textContent = totalStudents;
            mostPopularActivityEl.textContent = mostPopular;
            latestRecordEl.textContent = latestDate;

            // Display records
            let html = '<div class="space-y-6">';
            savedAttendanceRecords.forEach((record, index) => {
                const recordDate = new Date(record.date).toLocaleDateString('ms-MY');
                const createdDate = new Date(record.createdAt).toLocaleDateString('ms-MY');
                const createdTime = new Date(record.createdAt).toLocaleTimeString('ms-MY');
                
                html += `
                    <div class="border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h4 class="text-lg font-semibold text-gray-800">${record.activity}</h4>
                                <div class="flex items-center space-x-4 text-sm text-gray-600 mt-1">
                                    <span>📅 ${recordDate}</span>
                                    <span>🕐 ${record.time}</span>
                                    <span>👥 ${record.totalStudents} pelajar</span>
                                </div>
                            </div>
                            <div class="text-right text-xs text-gray-500">
                                <div>Disimpan: ${createdDate}</div>
                                <div>${createdTime}</div>
                            </div>
                        </div>
                        
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h5 class="font-medium text-gray-700 mb-3">Senarai Pelajar Hadir:</h5>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2">
                `;
                
                record.students.forEach(student => {
                    html += `
                        <div class="flex items-center space-x-2 text-sm">
                            <div class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium">
                                ${student.counter}
                            </div>
                            <div>
                                <div class="font-medium">${student.name}</div>
                                <div class="text-gray-600 text-xs">${student.id} • ${student.class}</div>
                            </div>
                        </div>
                    `;
                });
                
                html += `
                            </div>
                        </div>
                        
                        <div class="mt-4 flex justify-end">
                            <button onclick="deleteRecord(${index})" class="text-red-600 hover:text-red-800 text-sm font-medium flex items-center space-x-1">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                </svg>
                                <span>Padam Rekod</span>
                            </button>
                        </div>
                    </div>
                `;
            });
            html += '</div>';

            recordsList.innerHTML = html;
        }

        function deleteRecord(index) {
            if (confirm('Adakah anda pasti untuk memadam rekod ini? Tindakan ini tidak boleh dibatalkan.')) {
                savedAttendanceRecords.splice(index, 1);
                displayAttendanceRecords();
            }
        }

        let currentMode = 'select'; // 'select' or 'manual'

        // Activity change handler
        document.addEventListener('DOMContentLoaded', function() {
            const activitySelect = document.getElementById('activityType');
            if (activitySelect) {
                activitySelect.addEventListener('change', function() {
                    updateStudentList();
                });
            }
        });

        function switchToSelectMode() {
            currentMode = 'select';
            document.getElementById('selectFromListMode').classList.remove('hidden');
            document.getElementById('manualEntryMode').classList.add('hidden');
            document.getElementById('selectFromListBtn').classList.add('bg-blue-600', 'text-white');
            document.getElementById('selectFromListBtn').classList.remove('text-gray-600', 'hover:text-gray-800');
            document.getElementById('manualEntryBtn').classList.remove('bg-blue-600', 'text-white');
            document.getElementById('manualEntryBtn').classList.add('text-gray-600', 'hover:text-gray-800');
            updateStudentList();
        }

        function switchToManualMode() {
            currentMode = 'manual';
            document.getElementById('selectFromListMode').classList.add('hidden');
            document.getElementById('manualEntryMode').classList.remove('hidden');
            document.getElementById('manualEntryBtn').classList.add('bg-blue-600', 'text-white');
            document.getElementById('manualEntryBtn').classList.remove('text-gray-600', 'hover:text-gray-800');
            document.getElementById('selectFromListBtn').classList.remove('bg-blue-600', 'text-white');
            document.getElementById('selectFromListBtn').classList.add('text-gray-600', 'hover:text-gray-800');
        }

        function updateStudentList() {
            const activityType = document.getElementById('activityType').value;
            const studentListContainer = document.getElementById('studentListContainer');
            const noActivitySelected = document.getElementById('noActivitySelected');
            const selectedActivityName = document.getElementById('selectedActivityName');
            const studentCheckboxList = document.getElementById('studentCheckboxList');

            if (!activityType || currentMode !== 'select') {
                studentListContainer.classList.add('hidden');
                noActivitySelected.classList.remove('hidden');
                return;
            }

            const students = studentDatabase[activityType] || [];
            if (students.length === 0) {
                studentListContainer.classList.add('hidden');
                noActivitySelected.classList.remove('hidden');
                return;
            }

            // Show student list
            studentListContainer.classList.remove('hidden');
            noActivitySelected.classList.add('hidden');
            
            // Update activity name
            const activityNames = {
                'badminton': 'Badminton',
                'bola-sepak': 'Bola Sepak',
                'bola-keranjang': 'Bola Keranjang',
                'kelab-sains': 'Kelab Sains',
                'kelab-matematik': 'Kelab Matematik',
                'kelab-bahasa': 'Kelab Bahasa',
                'persatuan-sejarah': 'Persatuan Sejarah',
                'kadet-polis': 'Kadet Polis'
            };
            selectedActivityName.textContent = activityNames[activityType] || activityType;

            // Populate student checkboxes
            let html = '';
            students.forEach((student, index) => {
                const isChecked = attendanceData.some(s => s.id === student.id) ? 'checked' : '';
                html += `
                    <label class="flex items-center p-2 bg-white rounded border hover:bg-gray-50 cursor-pointer">
                        <input type="checkbox" value="${student.id}" ${isChecked} onchange="toggleStudentSelection('${student.id}')" class="mr-3 text-blue-600 focus:ring-blue-500">
                        <div class="flex-1">
                            <div class="font-medium text-gray-900 text-sm">${student.name}</div>
                            <div class="text-xs text-gray-600">${student.id} • ${student.class}</div>
                        </div>
                    </label>
                `;
            });
            studentCheckboxList.innerHTML = html;
        }

        function toggleStudentSelection(studentId) {
            const activityType = document.getElementById('activityType').value;
            const students = studentDatabase[activityType] || [];
            const student = students.find(s => s.id === studentId);
            
            if (!student) return;

            const existingIndex = attendanceData.findIndex(s => s.id === studentId);
            
            if (existingIndex >= 0) {
                // Remove student
                attendanceData.splice(existingIndex, 1);
            } else {
                // Add student
                studentCounter++;
                const studentData = {
                    counter: studentCounter,
                    name: student.name,
                    id: student.id,
                    class: student.class,
                    timestamp: new Date().toLocaleTimeString('ms-MY')
                };
                attendanceData.push(studentData);
            }
            
            updateAttendanceList();
        }

        function selectAllStudents() {
            const activityType = document.getElementById('activityType').value;
            const students = studentDatabase[activityType] || [];
            
            students.forEach(student => {
                const existingIndex = attendanceData.findIndex(s => s.id === student.id);
                if (existingIndex < 0) {
                    studentCounter++;
                    const studentData = {
                        counter: studentCounter,
                        name: student.name,
                        id: student.id,
                        class: student.class,
                        timestamp: new Date().toLocaleTimeString('ms-MY')
                    };
                    attendanceData.push(studentData);
                }
            });
            
            updateAttendanceList();
            updateStudentList(); // Refresh checkboxes
        }

        function clearAllStudents() {
            const activityType = document.getElementById('activityType').value;
            const students = studentDatabase[activityType] || [];
            
            students.forEach(student => {
                const existingIndex = attendanceData.findIndex(s => s.id === student.id);
                if (existingIndex >= 0) {
                    attendanceData.splice(existingIndex, 1);
                }
            });
            
            updateAttendanceList();
            updateStudentList(); // Refresh checkboxes
        }

        function addStudentManually() {
            const name = document.getElementById('studentName').value.trim();
            const studentId = document.getElementById('studentId').value.trim();
            const studentClass = document.getElementById('studentClass').value;

            if (!name || !studentId || !studentClass) {
                alert('Sila lengkapkan semua maklumat pelajar');
                return;
            }

            // Check for duplicate student ID
            if (attendanceData.some(student => student.id === studentId)) {
                alert('Pelajar dengan No. K/P atau No. Pelajar ini sudah didaftarkan');
                return;
            }

            studentCounter++;
            const student = {
                counter: studentCounter,
                name: name,
                id: studentId,
                class: studentClass,
                timestamp: new Date().toLocaleTimeString('ms-MY')
            };

            attendanceData.push(student);
            updateAttendanceList();
            clearStudentForm();
        }

        // Legacy function for backward compatibility
        function addStudent() {
            addStudentManually();
        }

        function removeStudent(studentId) {
            attendanceData = attendanceData.filter(student => student.id !== studentId);
            updateAttendanceList();
        }

        function updateAttendanceList() {
            const listContainer = document.getElementById('attendanceList');
            const totalStudentsSpan = document.getElementById('totalStudents');

            if (attendanceData.length === 0) {
                listContainer.innerHTML = '<p class="text-gray-500 text-center py-8">Belum ada pelajar didaftarkan. Sila tambah pelajar di atas.</p>';
                totalStudentsSpan.textContent = '0';
                return;
            }

            let html = '<div class="space-y-3">';
            attendanceData.forEach((student, index) => {
                html += `
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg border">
                        <div class="flex items-center space-x-4">
                            <div class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium">
                                ${student.counter}
                            </div>
                            <div>
                                <div class="font-medium text-gray-900">${student.name}</div>
                                <div class="text-sm text-gray-600">${student.id} • ${student.class}</div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3">
                            <span class="text-xs text-gray-500">${student.timestamp}</span>
                            <button onclick="removeStudent('${student.id}')" class="text-red-600 hover:text-red-800 p-1 rounded">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                `;
            });
            html += '</div>';

            listContainer.innerHTML = html;
            totalStudentsSpan.textContent = attendanceData.length;
        }

        function clearStudentForm() {
            document.getElementById('studentName').value = '';
            document.getElementById('studentId').value = '';
            document.getElementById('studentClass').value = '';
        }

        function clearForm() {
            if (attendanceData.length > 0) {
                if (confirm('Adakah anda pasti untuk mengosongkan semua data? Tindakan ini tidak boleh dibatalkan.')) {
                    attendanceData = [];
                    studentCounter = 0;
                    updateAttendanceList();
                    clearStudentForm();
                    document.getElementById('activityType').value = '';
                }
            }
        }

        // Handle form submission
        document.getElementById('attendanceForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const date = document.getElementById('attendanceDate').value;
            const activity = document.getElementById('activityType').value;
            const time = document.getElementById('attendanceTime').value;

            if (!date || !activity || !time) {
                alert('Sila lengkapkan maklumat tarikh, aktiviti dan masa');
                return;
            }

            if (attendanceData.length === 0) {
                alert('Sila tambah sekurang-kurangnya seorang pelajar');
                return;
            }

            // Simulate saving data
            const attendanceRecord = {
                date: date,
                activity: activity,
                time: time,
                students: [...attendanceData],
                totalStudents: attendanceData.length,
                createdAt: new Date().toISOString()
            };

            // Save to records array
            savedAttendanceRecords.push(attendanceRecord);

            // Show success message
            alert(`Kehadiran berjaya disimpan!\n\nTarikh: ${date}\nAktiviti: ${activity}\nMasa: ${time}\nJumlah Pelajar: ${attendanceData.length}\n\nRekod boleh dilihat di bahagian "Rekod Kehadiran"`);

            // Reset form
            attendanceData = [];
            studentCounter = 0;
            updateAttendanceList();
            clearStudentForm();
            document.getElementById('activityType').value = '';
            
            console.log('Attendance Record Saved:', attendanceRecord);
        });

        function displayMembershipRecords() {
            const membersList = document.getElementById('membersList');
            const totalMembersEl = document.getElementById('totalMembers');
            const activeMembersEl = document.getElementById('activeMembers');
            const popularActivityEl = document.getElementById('popularActivity');
            const latestMemberEl = document.getElementById('latestMember');

            // Reset filters to show all saved records
            filteredMembershipRecords = [...savedMembershipRecords];

            if (savedMembershipRecords.length === 0) {
                membersList.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                        </svg>
                        <p class="text-lg font-medium">Tiada ahli berdaftar lagi</p>
                        <p class="text-sm">Sila daftar ahli baru menggunakan "Daftar Keahlian" untuk melihat rekod di sini</p>
                        <div class="mt-4">
                            <button onclick="closeMembershipRecords(); openMembershipForm();" class="bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700 transition-colors">
                                ➕ Daftar Ahli Baru
                            </button>
                        </div>
                    </div>
                `;
                totalMembersEl.textContent = '0';
                activeMembersEl.textContent = '0';
                popularActivityEl.textContent = '-';
                latestMemberEl.textContent = '-';
                return;
            }

            updateMembershipStats();
            renderMembersList();
        }

        function updateMembershipStats() {
            const totalMembersEl = document.getElementById('totalMembers');
            const activeMembersEl = document.getElementById('activeMembers');
            const popularActivityEl = document.getElementById('popularActivity');
            const latestMemberEl = document.getElementById('latestMember');

            // Calculate statistics based on actual saved membership records
            const totalMembers = filteredMembershipRecords.length;
            const activeMembers = totalMembers; // All registered members are considered active
            
            // Find most popular unit from saved records
            const unitCount = {};
            filteredMembershipRecords.forEach(member => {
                unitCount[member.unitDisplayName] = (unitCount[member.unitDisplayName] || 0) + 1;
            });
            const mostPopular = Object.keys(unitCount).length > 0 ? 
                Object.keys(unitCount).reduce((a, b) => unitCount[a] > unitCount[b] ? a : b) : '-';
            
            // Latest member from saved records
            const latest = savedMembershipRecords.length > 0 ? 
                savedMembershipRecords[savedMembershipRecords.length - 1] : null;
            const latestName = latest ? latest.name.split(' ')[0] : '-';

            // Update statistics display
            totalMembersEl.textContent = totalMembers;
            activeMembersEl.textContent = activeMembers;
            popularActivityEl.textContent = mostPopular;
            latestMemberEl.textContent = latestName;
        }

        function renderMembersList() {
            const membersList = document.getElementById('membersList');
            
            if (filteredMembershipRecords.length === 0) {
                membersList.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 515.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                        </svg>
                        <p class="text-lg font-medium">Tiada ahli dijumpai</p>
                        <p class="text-sm">Cuba ubah kriteria penapis atau daftar ahli baru</p>
                    </div>
                `;
                return;
            }

            let html = '<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">';
            filteredMembershipRecords.forEach((member, index) => {
                const createdDate = new Date(member.createdAt).toLocaleDateString('ms-MY');
                const createdTime = new Date(member.createdAt).toLocaleTimeString('ms-MY');
                
                const typeColors = {
                    'kelab-persatuan': 'bg-blue-100 text-blue-800',
                    'sukan-permainan': 'bg-green-100 text-green-800',
                    'badan-beruniform': 'bg-purple-100 text-purple-800'
                };

                const typeNames = {
                    'kelab-persatuan': 'Kelab dan Persatuan',
                    'sukan-permainan': 'Sukan dan Permainan',
                    'badan-beruniform': 'Badan Beruniform'
                };
                
                html += `
                    <div class="bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow">
                        <div class="flex justify-between items-start mb-4">
                            <div class="flex-1">
                                <h4 class="text-lg font-semibold text-gray-800">${member.name}</h4>
                                <p class="text-sm text-gray-600">No. K/P: ${member.id}</p>
                                <p class="text-sm text-gray-600">Kelas ${member.class} • ${member.gender.charAt(0).toUpperCase() + member.gender.slice(1)}</p>
                            </div>
                            <div class="text-right">
                                <span class="px-2 py-1 text-xs font-medium rounded-full ${typeColors[member.coCurricularType] || 'bg-gray-100 text-gray-800'}">
                                    ${typeNames[member.coCurricularType] || member.coCurricularType}
                                </span>
                            </div>
                        </div>
                        
                        <div class="space-y-2 mb-4">
                            <div class="flex items-center text-sm text-gray-600">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"/>
                                </svg>
                                Unit: ${member.unitDisplayName}
                            </div>
                            <div class="flex items-center text-sm text-gray-600">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                                </svg>
                                Tel. Ibu/Bapa: ${member.parentPhone}
                            </div>
                            <div class="flex items-center text-sm text-gray-600">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                Didaftar: ${member.timestamp}
                            </div>
                        </div>
                        
                        <div class="flex justify-between items-center text-xs text-gray-500 pt-3 border-t border-gray-100">
                            <span>Disimpan: ${createdDate} ${createdTime}</span>
                            <button onclick="deleteMember(${savedMembershipRecords.indexOf(member)})" class="text-red-600 hover:text-red-800 font-medium flex items-center space-x-1">
                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                </svg>
                                <span>Padam</span>
                            </button>
                        </div>
                    </div>
                `;
            });
            html += '</div>';

            membersList.innerHTML = html;
        }

        function filterMembershipRecords() {
            const typeFilter = document.getElementById('filterCoCurricularType').value;
            const genderFilter = document.getElementById('filterGender').value;
            const searchTerm = document.getElementById('searchMember').value.toLowerCase();

            filteredMembershipRecords = savedMembershipRecords.filter(member => {
                const matchesType = !typeFilter || member.coCurricularType === typeFilter;
                const matchesGender = !genderFilter || member.gender === genderFilter;
                const matchesSearch = !searchTerm || 
                    member.name.toLowerCase().includes(searchTerm) ||
                    member.id.toLowerCase().includes(searchTerm) ||
                    member.class.toLowerCase().includes(searchTerm);
                
                return matchesType && matchesGender && matchesSearch;
            });

            updateMembershipStats();
            renderMembersList();
        }

        function deleteMember(index) {
            if (confirm('Adakah anda pasti untuk memadam ahli ini? Tindakan ini tidak boleh dibatalkan.')) {
                savedMembershipRecords.splice(index, 1);
                displayMembershipRecords();
            }
        }

        function clearMembershipForm() {
            document.getElementById('memberCoCurricularType').value = '';
            document.getElementById('memberUnit').value = '';
            document.getElementById('memberUnit').disabled = true;
            document.getElementById('memberUnit').innerHTML = '<option value="">Pilih jenis kokurikulum dahulu</option>';
            document.getElementById('memberForm').value = '';
            document.getElementById('memberClass').value = '';
            document.getElementById('memberClass').disabled = true;
            document.getElementById('memberClass').innerHTML = '<option value="">Pilih tingkatan dahulu</option>';
            document.getElementById('memberName').value = '';
            document.getElementById('memberGender').value = '';
            document.getElementById('memberId').value = '';
            document.getElementById('memberParentPhone').value = '';
            updateTimestamp();
        }

        // Handle membership form submission
        document.getElementById('membershipForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const timestamp = document.getElementById('memberTimestamp').textContent;
            const coCurricularType = document.getElementById('memberCoCurricularType').value;
            const unit = document.getElementById('memberUnit').value;
            const memberForm = document.getElementById('memberForm').value;
            const memberClass = document.getElementById('memberClass').value;
            const name = document.getElementById('memberName').value.trim();
            const gender = document.getElementById('memberGender').value;
            const memberId = document.getElementById('memberId').value.trim();
            const parentPhone = document.getElementById('memberParentPhone').value.trim();

            if (!coCurricularType || !unit || !memberForm || !memberClass || !name || !gender || !memberId || !parentPhone) {
                alert('Sila lengkapkan semua medan yang wajib diisi (bertanda *)');
                return;
            }

            // Validate IC format
            const icPattern = /^[0-9]{6}-[0-9]{2}-[0-9]{4}$/;
            if (!icPattern.test(memberId)) {
                alert('Format No. Kad Pengenalan tidak sah. Sila gunakan format: 123456-78-9012');
                return;
            }

            // Validate phone format
            const phonePattern = /^[0-9]{3}-[0-9]{7,8}$/;
            if (!phonePattern.test(parentPhone)) {
                alert('Format No. Telefon tidak sah. Sila gunakan format: 012-3456789');
                return;
            }

            // Check for duplicate member ID
            if (savedMembershipRecords.some(member => member.id === memberId)) {
                alert('Ahli dengan No. Kad Pengenalan ini sudah berdaftar');
                return;
            }

            // Get unit display name
            const unitSelect = document.getElementById('memberUnit');
            const unitDisplayName = unitSelect.options[unitSelect.selectedIndex].text;

            // Create membership record
            const membershipRecord = {
                timestamp: timestamp,
                coCurricularType: coCurricularType,
                unit: unit,
                unitDisplayName: unitDisplayName,
                class: memberClass,
                name: name,
                gender: gender,
                id: memberId,
                parentPhone: parentPhone,
                createdAt: new Date().toISOString()
            };

            // Save to records array
            savedMembershipRecords.push(membershipRecord);

            // Show success message
            const typeNames = {
                'kelab-persatuan': 'Kelab dan Persatuan',
                'sukan-permainan': 'Sukan dan Permainan',
                'badan-beruniform': 'Badan Beruniform'
            };

            alert(`Keahlian berjaya didaftarkan!\n\nNama: ${name}\nJenis: ${typeNames[coCurricularType]}\nUnit: ${unitDisplayName}\nKelas: ${memberClass}\n\nRekod boleh dilihat di bahagian "Rekod Keahlian"`);

            // Reset form
            clearMembershipForm();
            
            console.log('Membership Record Saved:', membershipRecord);
        });

        // Allow Enter key to add student
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && (e.target.id === 'studentName' || e.target.id === 'studentId')) {
                e.preventDefault();
                addStudent();
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97a3774343b41fe1',t:'MTc1NzA1MTYwMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
